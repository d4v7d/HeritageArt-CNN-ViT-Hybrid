# POC-6: Hierarchical ConvNeXt-Tiny (High Resolution)
# Innovation #1: Hierarchical Multi-Task Learning
# Resolution: 768x768 (2x original) to capture fine details (Cracks, Scratches)

model:
  hierarchical: true
  encoder: convnext_tiny
  encoder_weights: imagenet
  classes: 16
  upernet:
    ppm_pool_scales: [1, 2, 3, 6]
    fpn_out_channels: 256
    dropout: 0.1

data:
  data_dir: ../common-data/artefact_augmented
  image_size: 768
  num_workers: 16
  use_augmented: true
  hierarchical: true

training:
  batch_size: 8   # Reduced for 768x768 (4x pixels -> 1/4 batch)
  epochs: 100
  learning_rate: 0.0001
  weight_decay: 0.01
  mixed_precision: true
  gradient_clip: 1.0
  curriculum: true

loss:
  type: hierarchical
  binary_weight: 0.2
  coarse_weight: 0.3
  fine_weight: 1.0

optimizer:
  type: adamw
  betas: [0.9, 0.999]

scheduler:
  type: onecycle
  max_lr: 0.0001
  pct_start: 0.3
  anneal_strategy: cos

dataloader:
  num_workers: 8
  pin_memory: true
  persistent_workers: true
  prefetch_factor: 2
  drop_last: true
