Bootstrap: docker
From: nvidia/cuda:11.4.2-cudnn8-devel-ubuntu20.04

%labels
    Author d4v7d
    Version 1.0

%post
    export DEBIAN_FRONTEND=noninteractive
    apt-get update && apt-get install -y \
        software-properties-common \
        build-essential \
        wget \
        git \
        ca-certificates \
        libgl1-mesa-glx \
        libglib2.0-0 \
        python3.11 \
        python3.11-venv \
        python3.11-distutils \
        python3-pip \
    && rm -rf /var/lib/apt/lists/*

    update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.11 1 || true
    python3 -m pip install --upgrade pip setuptools wheel

    # copy requirements if present in build context
    if [ -f /workspace/requirements.txt ]; then
        pip install --no-cache-dir -r /workspace/requirements.txt || true
    fi

%environment
    export LC_ALL=C
    export LANG=C

%runscript
    exec /bin/bash "$@"
